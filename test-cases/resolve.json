{
  "name": "testResolve",
  "description": "resolve() with model provider",
  "source": "user-feedback",
  "tests": [
    {
      "name": "testResolveBundle",
      "expression": "Bundle.entry.resource.where(resourceType='MedicationRequest').medicationReference.resolve().count()",
      "input": null,
      "tags": [
        "resolve"
      ],
      "inputfile": "bundle-small.json",
      "expected": [
        14
      ]
    },
    {
      "name": "testResolveBundle",
      "expression": "Bundle.entry.resource.where(resourceType='MedicationRequest').medicationReference.resolve().first()",
      "input": null,
      "tags": [
        "resolve"
      ],
      "inputfile": "bundle-small.json",
      "expected": [
        {
          "code": {
            "coding": [
              {
                "code": "62584089701",
                "system": "http://fhir.mimic.mit.edu/CodeSystem/medication-ndc"
              }
            ]
          },
          "id": "60d3201b-f9da-5dc8-956f-fc72c515e953",
          "identifier": [
            {
              "system": "http://fhir.mimic.mit.edu/CodeSystem/medication-ndc",
              "value": "62584089701"
            },
            {
              "system": "http://fhir.mimic.mit.edu/CodeSystem/medication-formulary-drug-cd",
              "value": "FOLI1"
            },
            {
              "system": "http://fhir.mimic.mit.edu/CodeSystem/medication-name",
              "value": "FoLIC Acid"
            }
          ],
          "meta": {
            "lastUpdated": "2025-07-30T17:39:59.813+00:00",
            "profile": [
              "http://fhir.mimic.mit.edu/StructureDefinition/mimic-medication"
            ],
            "versionId": "1"
          },
          "resourceType": "Medication",
          "text": {
            "div": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div class=\"hapiHeaderText\"> 62584089701 </div></div>",
            "status": "generated"
          }
        }
      ]
    },
    {
      "name": "testResolveContained",
      "expression": "DiagnosticReport.specimen.resolve().resourceType",
      "input": {
        "resourceType": "DiagnosticReport",
        "id": "example",
        "status": "final",
        "category": [
          {
            "coding": [
              {
                "system": "http://terminology.hl7.org/CodeSystem/v2-0074",
                "code": "LAB"
              }
            ]
          }
        ],
        "code": {
          "coding": [
            {
              "system": "http://loinc.org",
              "code": "58410-2"
            }
          ]
        },
        "subject": {
          "reference": "Patient/example"
        },
        "effectiveDateTime": "2011-03-04T08:30:00+11:00",
        "issued": "2011-03-04T11:45:33+11:00",
        "performer": [
          {
            "reference": "Organization/example"
          }
        ],
        "specimen": [
          {
            "reference": "#specimen-1"
          }
        ],
        "contained": [
          {
            "resourceType": "Specimen",
            "id": "specimen-1",
            "status": "available",
            "type": {
              "coding": [
                {
                  "system": "http://snomed.info/sct",
                  "code": "122555007",
                  "display": "Venous blood specimen"
                }
              ]
            },
            "subject": {
              "reference": "Patient/example"
            }
          }
        ]
      },
      "tags": [
        "resolve",
        "contained"
      ],
      "expected": [
        "Specimen"
      ]
    }
  ]
}
