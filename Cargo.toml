[package]
name = "octofhir-fhirpath"
version = "0.2.0"
edition = "2024"
authors = ["OctoFHIR Team <funyloony@gmail.com>"]
license = "MIT OR Apache-2.0"
repository = "https://github.com/octofhir/fhirpath-rs"
homepage = "https://github.com/octofhir/fhirpath-rs"
documentation = "https://docs.rs/octofhir-fhirpath"
description = "A high-performance FHIRPath implementation in Rust with comprehensive spec compliance"
readme = "README.md"
keywords = ["fhir", "fhirpath", "healthcare", "hl7", "parser"]
categories = ["parser-implementations", "data-structures", "science"]
include = [
    "src/**/*",
    "specs/**/*",
    "tests/**/*",
    "benches/**/*",
    "Cargo.toml",
    "README.md",
    "LICENSE*",
    "CHANGELOG.md",
]
exclude = [
    "src/bin/extract_benchmark_metrics.rs",
    "src/bin/test_runner.rs",
    "src/bin/perf-test.rs",
    "src/bin/performance_baseline.rs",
    "src/bin/flamegraph_baseline.rs",

]

[lib]
name = "octofhir_fhirpath"
path = "src/lib.rs"

[[bench]]
name = "fhirpath_benchmark"
harness = false

[[bench]]
name = "bundle_optimization_baseline"
harness = false

[[bin]]
name = "octofhir-fhirpath"
path = "src/bin/octofhir_fhirpath.rs"

[[bin]]
name = "octofhir-fhirpath-lsp"
path = "src/bin/fhirpath_lsp.rs"
required-features = ["lsp"]

[dependencies]
# Core dependencies
anyhow = "1.0.98"
base64 = "0.22.1"
chrono = { version = "0.4.41", features = ["serde"] }
dashmap = "6.1.0"
glob = "0.3"
hex = "0.4"
indexmap = "2.10.0"
log = "0.4.20"
lru = "0.16"
nom = "8.0.0"
nom_locate = "5.0.0-beta.5"
octofhir-ucum = { version = "0.5.1", features = ["fhir", "serde"] }
octofhir-fhir-model = { version = "0.1.1", features = ["serde"] }
octofhir-fhirschema = { version = "0.2.2", features = ["memory-storage"] }
octofhir-canonical-manager = { version = "0.1.3" }
url = "2.5"
parking_lot = "0.12.4"
regex = "1.11.1"
rust_decimal = { version = "1.37.2", features = ["serde-with-str"] }
rustc-hash = "2.1.0"
serde = { version = "1.0.219", features = ["derive"] }
serde_json = "1.0.142"
smallvec = { version = "1.11", features = ["serde"] }
thiserror = "2.0.12"
typed-arena = "2.0.2"
bumpalo = { version = "3.16", features = ["collections"] }
unicode-xid = "0.2.6"
once_cell = "1.21"
pprof = { version = "0.15.0", features = ["flamegraph"], optional = true }

# Async dependencies
async-trait = "0.1"
futures = "0.3"
tokio = { version = "1.47.1", features = ["full"] }

# HTTP client for external profile fetching
reqwest = { version = "0.12.22", features = ["json"] }

colored = { version = "3.0.0", optional = true }
lsp-types = { version = "0.97.0", optional = true }
tower-lsp = { version = "0.20.0", optional = true }
env_logger = { version = "0.11.0", optional = true }

# CLI dependencies
clap = { version = "4", features = ["derive"] }
human-panic = "2.0"

[dev-dependencies]
comfy-table = "7.0"
criterion = { version = "0.7.0", features = ["html_reports"] }
pretty_assertions = "1.4.1"
rstest = "0.26"
serde-xml-rs = "0.8"
colored = "3.0.0"
glob = "0.3"
tokio = { version = "1.47.0", features = [
    "rt",
    "rt-multi-thread",
    "macros",
    "test-util",
] }

[features]
default = []
lsp = ["lsp-types", "tower-lsp", "colored", "env_logger"]
diagnostics = ["colored"]
serde = []
terminal = ["colored"]
profiling = ["dep:pprof"]
